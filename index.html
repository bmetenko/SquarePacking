<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>PyScript Square Packing</title>

    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />

    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <style>
      button {
        color: black;
        background-color: lightblue;
        padding: 5px;
        margin: 5px;
        border-radius: 5px;
      }
      input {
        margin: 5px;
        border-color: aliceblue;
        border: 2px;
        border-style: solid;
        padding: 2px;
      }
      input[type=number] {text-align: right;}
      #controls {
        background-color: rgb(178, 248, 238);
        display: flex;
        justify-content: center;
      }
      label {
        align-self: center;
      }
    </style>

    <script type='text/javascript'>
      function plot(graph, chart) {
          var figure = JSON.parse(graph)
          var layout = {
            autosize: true
          };

          Plotly.newPlot(chart, figure, layout);

          function resP(id){
            var d3 = Plotly.d3;

            var parent_width = document.getElementById("chart1").parentElement.clientWidth
            var gd3 = d3.select(document.getElementById(id))
              .style({
              width: parent_width - 10,
              });
            return gd3.node();
          }

          window.addEventListener('resize', function(){
            Plotly.Plots.resize( resP(chart) );
          })

      }
      
    </script>

  </head>

  <body>

<py-env>
  - pandas
  - numpy
  - plotly
  - paths:
      - ./squares.py
</py-env>

<div id="controls">
  <button id="reset-canvas" style="background-color: pink;">
    Reset Canvas
  </button>
  <label>
    Canvas Size:
  </label>
  <input id="canvas-size" value="5"type="number" min="5", max="100">
  </input>

  <button id="canvas-size-update" type="button">
    Update Canvas Size
  </button>

  <label>
    Width:
  </label>
  <input id="width" value="1" type="number" min="1", max="10">
  </input>

  <label>
    Length:
  </label>
  <input id="width" value="1" type="number" min="1", max="10">
  </input>

  <button id="add-rect" type="button">
    Add Rectangle
  </button>

</div>

<div id="chart-row" style="display: flex; justify-content: center;">
  <div id="chart-container" style="width: 75%;height: 50%;">
    <div id="chart1" style="width: 100%; height: 100%;"></div>
  </div>
</div>

<py-script>
import js
import json
import pandas as pd
import numpy as np
import plotly
import plotly.graph_objects as go
import plotly.io as pio
from squares import Square, SquareCanvas, check_bounds

list_square_radii_1 = [3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]
list_squares_1 = [Square(radius) for radius in list_square_radii_1]

B = SquareCanvas(max_bound=8, contents=list_squares_1)

fig = B.generate_plotly(render="object")

graphJSON = json.dumps(
  fig, 
  cls=plotly.utils.PlotlyJSONEncoder
)
js.plot(graphJSON,"chart1")

    </py-script>

  </body>
</html>